<div class="virtual-grouping-sidebar">
    <div class="header">
        <h3>Virtual Grouping Sidebar</h3>
        <button class="close-btn" (click)="close()">Close</button>
    </div>
    <div class="content">
        <!-- New input box on top that shows selected tokens -->
        <div class="selected-tokens-container">
            <input type="text" class="selected-tokens-input" [value]="getSelectedTokensAsString()" readonly />
        </div>

        <!-- The single scrollable list containing group headers and options -->
        <ul class="option-list" [class.expanded]="listExpanded">
            <ng-container *ngFor="let group of groupKeys">
                <!-- Group header -->
                <li class="group-header">{{ group }}</li>
                <!-- Iterate through options of this group -->
                <ng-container *ngFor="let option of aggregatedOptions[group]">
                    <li class="option">
                        <span class="option-text">{{ option }}</span>
                        <!-- The toggle button: show '+' if token not selected; '-' if already selected -->
                        <span class="toggle-token-btn" (click)="toggleToken(option); $event.stopPropagation();">
                            {{ isTokenSelected(option) ? '-' : '+' }}
                        </span>
                    </li>
                </ng-container>
            </ng-container>
        </ul>

        <!-- Toggle button for expanding or collapsing the list -->
        <button class="toggle-btn" (click)="toggleList()">
            {{ listExpanded ? 'Collapse List' : 'Expand List' }}
        </button>
    </div>
</div>